{% load render_table from django_tables2 %}
<div id="connection-overview">
    <div id="add-btn">
    <span title="Add a new connection">
        <a href="{% url "connections:connections_choose" %}" id="add" class="btn btn-orange btn-lg pull-right">
            <span class="glyphicon glyphicon-plus"></span> Add
        </a>
    </span>
    </div>
<div id="con-table">
    {% if table %}
        <div class="col-xs-12">
        {% render_table table 'certificates/widgets/table.html' %}
        </div>
    {% else %}
        <h3 id="no_certs_to_show">No certificates to show</h3>
    {% endif %}
</div>
    <div>
        <table class="table table-striped">
            <thead>
            <tr>
                <th>Profile</th>
                <th>Remote</th>
                <th>State</th>
                <th><span class="pull-right">Remove / Edit</span></th>
            </tr>
            </thead>
            <tbody>
            {% for connection in connections %}
                <tr>
                    <td><a class="profilelink"
                           href="{% url "connections:connection_update" connection.id %}"><b>{{ connection.profile }}</b></a>
                    </td>
                    <td>{{ connection.remote }}</td>
                    <td>
                    <span title="Turn connection on / off">
                        <div class="btn-toolbar">
                            <form id="toggle_connection" action="{% url 'connections:connection_toggle' %}"
                                  style="display: inline;">
                                {% csrf_token %}
                                <input type="hidden" name="id" value="{{ connection.id }}">
                                <input type="hidden" name="connection_type" value="{{ connection.connection_type }}">
                                <input id="toggle_input{{ connection.id }}" type="checkbox" data-toggle="toggle"
                                       data-onstyle="success"
                                       data-offstyle="default"
                                       {% if connection.state %}checked{% endif %} onclick="this.form.click()">
                            </form>
                            <div id="alert_{{ connection.id }}" class="btn"></div>
                        </div>
                    </span>
                    </td>
                    <td>
                        <div class="pull-right">
                        <span title="Remove connection">
                        <a href="{{ connection.delete }}" id="delete-{{ connection.id }}"
                           class="btn btn-default white-background black remove-btn">
                            <span class="glyphicon glyphicon-remove"></span> <span class="removebtn-text"></span>
                        </a>
                        </span>

                        </div>
                    </td>
                </tr>
            {% endfor %}
            <script>
                $(".remove-btn").click(function () {
                    btn = $(this);
                    if (btn.hasClass('btn-default')) {
                        btn.removeClass('btn-default').addClass('btn-danger');
                        btn.children('.removebtn-text').text('Remove connection');
                        return false;
                    } else {
                        return true;
                    }
                });


            </script>
            </tbody>
        </table>
    </div>
</div>